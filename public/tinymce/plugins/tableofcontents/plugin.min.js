tinymce.PluginManager.add("tableofcontents",(e=>{const t=()=>{const t=(()=>{const t=e.getContent(),n=document.createElement("div");n.className="mce-toc";const c="Table of Contents";n.innerHTML=`<h2 class="toc-title">${c}</h2>`;const o=document.createElement("div");o.className="toc-wrapper";let s=0,a=0,i=0;return t.replace(/<(h[1-6])([^>]*)>(.*?)<\/\1>/gi,((t,n,r,d)=>{if(d.trim()===c)return t;const l=r.match(/id="([^"]+)"/),m=l?l[1]:d.trim().toLowerCase().replace(/\s+/g,"-");if(m&&!r.includes(`id="${m}"`)){const t=e.dom.select(n).find((e=>e.innerHTML.includes(d)));t&&e.dom.setAttrib(t,"id",m)}const u=document.createElement("div");u.className=`toc-item toc-${n}`;let h="";switch(n){case"h1":s++,a=0,i=0,h=`${s}. `;break;case"h2":a++,h=`${s}.${a} `;break;case"h3":i++,h=`${s}.${a}.${i} `;break;default:h=""}u.innerHTML=`<a href="#${m}">${h}${d}</a>`,o.appendChild(u)})),n.appendChild(o),n.outerHTML})(),n=e.dom.select(".mce-toc");n.length?e.dom.setHTML(n[0],t):e.insertContent(t)};e.ui.registry.addMenuItem("tableofcontents",{text:"Table of contents",icon:"unordered-list",onAction:()=>t()})}));