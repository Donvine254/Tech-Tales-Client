tinymce.PluginManager.add("tableofcontents",(e=>{const t=()=>{const t=(()=>{const t=e.getContent(),n=document.createElement("div");n.className="mce-toc";const c="Table of Contents";n.innerHTML=`<h2 class="toc-title">${c}</h2>`;const o=document.createElement("div");o.className="toc-wrapper";let a=0,s=0,i=0,r=0;return t.replace(/<(h[1-6])([^>]*)>(.*?)<\/\1>/gi,((t,n,d,l)=>{if(l.trim()===c)return t;const m=d.match(/id="([^"]+)"/),$=m?m[1]:l.trim().toLowerCase().replace(/\s+/g,"-");if($&&!d.includes(`id="${$}"`)){const t=e.dom.select(n).find((e=>e.innerHTML.includes(l)));t&&e.dom.setAttrib(t,"id",$)}const h=document.createElement("div");h.className=`toc-item toc-${n}`;let u="";switch(n){case"h1":a++,s=0,i=0,u=`${a}. `;break;case"h2":s++,u=`${a>0?a+".":""}${s} `;break;case"h3":i++,u=`${a>0?a+".":""}${s>0?s+".":""}${i} `;break;case"h4":r++,u=`${a>0?a+".":""}${s>0?s+".":""}${i>0?i+".":""}${r} `;break;default:u=""}h.innerHTML=`<a href="#${$}">${u}${l}</a>`,o.appendChild(h)})),n.appendChild(o),n.outerHTML})(),n=e.dom.select(".mce-toc");n.length?e.dom.setHTML(n[0],t):e.insertContent(t)};e.ui.registry.addMenuItem("tableofcontents",{text:"Table of contents",icon:"unordered-list",onAction:()=>t()})}));