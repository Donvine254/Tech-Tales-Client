tinymce.PluginManager.add("tableofcontents",(e=>{const t=()=>{const t=(()=>{const t=e.getContent(),n=document.createElement("div");n.className="mce-toc";const c="Table of Contents";n.innerHTML=`<h2 class="toc-title">${c}</h2>`;const o=document.createElement("div");function l(...e){return e.filter((e=>"number"==typeof e&&e>0)).join(".")+". "}o.className="toc-wrapper";let a=0,s=0,i=0,r=0;return t.replace(/<(h[1-6])([^>]*)>(.*?)<\/\1>/gi,((t,n,d,m)=>{if(m.trim()===c)return t;const u=d.match(/id="([^"]+)"/),h=u?u[1]:m.trim().toLowerCase().replace(/\s+/g,"-");if(h&&!d.includes(`id="${h}"`)){const t=e.dom.select(n).find((e=>e.innerHTML.includes(m)));t&&e.dom.setAttrib(t,"id",h)}const f=document.createElement("div");f.className=`toc-item toc-${n}`;let b="";switch(n){case"h1":a++,s=0,i=0,b=l(a);break;case"h2":s++,b=l(a>0?a:null,s);break;case"h3":i++,b=l(a>0?a:null,s>0?s:null,i);break;case"h4":r++,b=l(a>0?a:null,s>0?s:null,i>0?i:null,r);break;default:b=""}f.innerHTML=`<a href="#${h}">${b}${m}</a>`,o.appendChild(f)})),n.appendChild(o),n.outerHTML})(),n=e.dom.select(".mce-toc");n.length?e.dom.setHTML(n[0],t):e.insertContent(t)};e.ui.registry.addMenuItem("tableofcontents",{text:"Table of contents",icon:"unordered-list",onAction:()=>t()})}));