tinymce.PluginManager.add("importword",(e,t)=>{e.ui.registry.addButton("importword",{icon:"import-word",tooltip:"import from Word",onAction(){getFile()}}),e.ui.registry.addMenuItem("importword",{text:"Import from Word",icon:"import-word",onAction(){getFile()}})});const getFile=()=>{let e=document.getElementById("fileInput");e||((e=document.createElement("input")).type="file",e.accept=".docx",e.style.display="none",e.id="fileInput",document.body.appendChild(e),e.addEventListener("change",t=>{let o=t.target.files[0],r=tinymce.activeEditor;if(o&&("application/vnd.openxmlformats-officedocument.wordprocessingml.document"!==o.type||!o.name.endsWith(".docx")))return r.notificationManager.open({text:"Wrong file format provided, please select a .docx file.",type:"warning",timeout:3e3}),r.setProgressState(!1),null;if(r.setProgressState(!0),o){let i=new FileReader;i.onload=t=>{let o=t.target.result;mammoth.convertToHtml({arrayBuffer:o}).then(e=>{let t=e.value;r.insertContent(`<div>${t}</div>`)}).catch(e=>{console.error("Error converting .docx to HTML:",e),r.notificationManager.open({text:"Wrong file format provided, please select a .docx file.",type:"warning",timeout:3e3})}).finally(()=>{e.remove(),r.setProgressState(!1)})},i.readAsArrayBuffer(o)}})),e.click()};