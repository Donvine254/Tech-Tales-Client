tinymce.PluginManager.add("ai",function(t,e){let o=()=>{t.windowManager.open({title:"AI Assistant",body:{type:"panel",items:[{type:"htmlpanel",name:"responsePanel",html:`<div id="ai-response-container" style="padding: 10px; max-height:250px; overflow-y:scroll;"> 
</div>`},{type:"input",name:"prompt",placeholder:"Ask AI to edit or generate"},]},buttons:[{type:"cancel",text:"Close"},{type:"submit",name:"submitButton",text:"Send",buttonType:"primary"},],onSubmit(t){let e=t.getData();if(!e.prompt)return alert("Kindly enter a prompt first!"),!1;fetch("http://localhost:3000/api/gemini",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"This is a rich text editor for a blog. You are being asked to help generate a blog or edit some text. Make sure your response is in html format. No need to indicate the format in the response, just be direct",body:e.prompt})}).then(t=>t.json()).then(t=>{let e=`<div style="margin-bottom:5px;">${t.message}
<button style="background-color: #006CE7; color: white; padding: 5px 12px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;"  onclick="insertContent(${JSON.stringify(t)})">Insert </button><button style="background-color: #f2f3f4; color: black; padding: 5px 12px; border: none; border-radius: 4px; cursor: not-allowed;" disabled>Stop </button>
</div>`,o=document.getElementById("ai-response-container");o.style.border="1px solid gray",o.style.borderRadius="5px",o.innerHTML=e}).catch(t=>{console.error("Error fetching AI response:",t),alert("Failed to fetch AI response.")}),t.setData({prompt:""})}})};return t.ui.registry.addButton("ai",{icon:"ai",tooltip:"Ask AI",onAction:function(){o()}}),t.ui.registry.addMenuItem("ai",{text:"AI Assistant",onAction:function(){o()}}),{getMetadata:function(){return{name:"AI Assistant",url:"http://exampleplugindocsurl.com"}}}});const insertContent=t=>{console.log(t),tinymce.activeEditor.insertContent(`<div>${t.message}</div>`),tinymce.activeEditor.windowManager.close()};